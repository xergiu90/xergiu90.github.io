{"version":3,"sources":["./src/app/pages/home/home.component.ts","./src/app/pages/home/home.component.html","./src/app/pages/home/home.routes.ts","./src/app/pages/home/home.module.ts"],"names":[],"mappings":"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","file":"pages-home-home-module.js","sourcesContent":["import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { FormControl } from '@angular/forms';\r\nimport { MatDialog, MatDialogConfig } from '@angular/material/dialog';\r\nimport { IGenre } from '@core/interfaces/genre.interface';\r\nimport { IMovie } from '@core/interfaces/movie.interface';\r\nimport { User } from '@core/models/user.model';\r\nimport { AuthenticationService, MovieService, StateService } from '@core/services';\r\nimport { MovieDetailsComponent } from '@shared/components/movie-details/movie-details.component';\r\nimport { ToastrService } from 'ngx-toastr';\r\nimport { Subscription } from 'rxjs';\r\nimport { debounceTime, distinctUntilChanged, tap } from 'rxjs/operators';\r\nimport { faHeart } from '@fortawesome/free-solid-svg-icons';\r\n\r\n@Component({\r\n  selector: 'favorites',\r\n  templateUrl: './home.component.html',\r\n  styleUrls: ['./home.component.scss'],\r\n})\r\nexport class HomeComponent implements OnInit, OnDestroy {\r\n  currentUser: User;\r\n  movies: IMovie[] = [];\r\n  favourites: IMovie[] = [];\r\n  firstLoad = true;\r\n  apiKeySubscription: Subscription;\r\n  sortBy = 'name';\r\n  searchTerm: string;\r\n  searchField: FormControl;\r\n  loading: boolean = false;\r\n  filterByYear: number;\r\n  filterByGenre: number;\r\n  genreName: any;\r\n  faHeart = faHeart;\r\n\r\n  get movieYears() {\r\n    const uniqueYears = [...new Set(this.movies.map(mov => mov.year))].sort((a, b) => {\r\n      return b - a;\r\n    });\r\n    return uniqueYears;\r\n  }\r\n\r\n  get movieGenres(): number[] {\r\n    const allGenres = this.flatten(this.movies.map(movie => movie.genre));\r\n    const uniqueGenres = [...new Set(allGenres)] as number[];\r\n    return uniqueGenres;\r\n  }\r\n\r\n  get sortedAndFilteredMovies(): IMovie[] {\r\n    let sortedAndFilteredMovies = [...this.movies];\r\n    if (this.filterByYear) {\r\n      sortedAndFilteredMovies = [...sortedAndFilteredMovies.filter(mov => mov.year === this.filterByYear)];\r\n    }\r\n    if (this.filterByGenre) {\r\n      sortedAndFilteredMovies = [...sortedAndFilteredMovies.filter(mov => mov.genre.includes(this.filterByGenre))];\r\n    }\r\n\r\n    return sortedAndFilteredMovies;\r\n  }\r\n\r\n  get favouriteMoviesIDs(): string[] {\r\n    if (this.favourites && this.favourites.length) {\r\n      return this.favourites.map(movie => movie.id);\r\n    } else {\r\n      return [];\r\n    }\r\n\r\n  }\r\n\r\n\r\n  constructor(\r\n    private authService: AuthenticationService,\r\n    private stateService: StateService,\r\n    private movieService: MovieService,\r\n    private dialog: MatDialog,\r\n    private toastr: ToastrService,\r\n  ) {\r\n    this.searchField = new FormControl();\r\n    this.stateService.getCurrentUser().subscribe(\r\n      user => {\r\n        this.currentUser = user;\r\n      }\r\n    );\r\n  }\r\n\r\n  ngOnInit(): void {\r\n\r\n    this.apiKeySubscription = this.stateService.getApiKey().subscribe(apiKey => {\r\n      this.searchMovies(this.searchField.value);\r\n    });\r\n\r\n    this.fetchGenres();\r\n    this.searchField.valueChanges.pipe(\r\n      debounceTime(600),\r\n      distinctUntilChanged(),\r\n      tap(_ => {\r\n        this.loading = true;\r\n      }),\r\n      tap(_ => (this.loading = false))\r\n    ).subscribe(term => {\r\n      this.searchMovies(term);\r\n    });\r\n    this.readFavourites();\r\n\r\n  }\r\n\r\n\r\n  searchMovies(term: string) {\r\n    if (!term) {\r\n      return;\r\n    }\r\n\r\n    if (!this.genreName) {\r\n      this.fetchGenres();\r\n    } else {\r\n      this.movieSearch(term);\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.apiKeySubscription) {\r\n      this.apiKeySubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  movieSearch(term: string) {\r\n    this.movieService.search(term).subscribe(res => {\r\n        let newMovie: IMovie;\r\n        this.movies = [];\r\n        res.results.forEach(movie => {\r\n          newMovie = {\r\n            name: movie.original_title,\r\n            year: movie.release_date ? movie.release_date.split('-')[0] : '-',\r\n            genre: movie.genre_ids,\r\n            rating: movie.vote_average,\r\n            posterURL: movie.poster_path ? 'https://image.tmdb.org/t/p/w440_and_h660_face' + movie.poster_path : 'https://www.allianceplast.com/wp-content/uploads/2017/11/no-image.png',\r\n            description: movie.overview,\r\n            id: movie.id,\r\n            isFavourite: this.favouriteMoviesIDs.includes(movie.id)\r\n          };\r\n          this.movies.push(newMovie);\r\n\r\n        });\r\n        this.doSort();\r\n      },\r\n      err => {\r\n        if (!this.firstLoad) {\r\n          this.toastr.error('API Key invalid');\r\n        }\r\n\r\n        console.log(err);\r\n      });\r\n  }\r\n\r\n  fetchGenres() {\r\n    this.movieService.getGenres().subscribe(res => {\r\n        if (res) {\r\n          this.genreName = res.genres.reduce((map: any, genre: IGenre) => {\r\n            map[genre.id as any] = genre.name;\r\n            return map;\r\n          }, {});\r\n\r\n          if (this.searchField.value) {\r\n            this.movieSearch(this.searchField.value);\r\n          }\r\n          this.firstLoad = false;\r\n        }\r\n\r\n      },\r\n      err => {\r\n        if (!this.firstLoad) {\r\n          this.toastr.error('API Key invalid');\r\n        }\r\n        console.log(err);\r\n        this.firstLoad = false;\r\n      });\r\n  }\r\n\r\n  readFavourites() {\r\n    const storedMoviesString = JSON.parse(localStorage.getItem('favourites'));\r\n    if (storedMoviesString) {\r\n      const storedMoviesObject = storedMoviesString[this.currentUser.id];\r\n      if (storedMoviesObject) {\r\n        this.favourites = storedMoviesObject;\r\n      }\r\n    }\r\n  }\r\n\r\n  showMovieDetails(movie: IMovie) {\r\n    const dialogConfig = new MatDialogConfig();\r\n    dialogConfig.width = '500px';\r\n    dialogConfig.hasBackdrop = true;\r\n    dialogConfig.closeOnNavigation = true;\r\n    const dialogRef = this.dialog.open(MovieDetailsComponent, dialogConfig);\r\n    dialogRef.componentInstance.movie = movie;\r\n\r\n  }\r\n\r\n  updateSort() {\r\n    this.doSort();\r\n  }\r\n\r\n  doSort() {\r\n    if (this.sortBy === 'year') {\r\n      this.movies.sort((a, b) => {\r\n        return b.year - a.year;\r\n      });\r\n    } else if (this.sortBy === 'name') {\r\n      this.movies.sort((a, b) => {\r\n        return a.name.localeCompare(b.name);\r\n      });\r\n    }\r\n  }\r\n\r\n  toggleFavourites(movie: IMovie) {\r\n    movie.isFavourite =  !movie.isFavourite;\r\n    const favMovies = this.movies.filter(mov => {\r\n      return mov.isFavourite;\r\n    });\r\n\r\n    let favMoviesPerUser = JSON.parse(localStorage.getItem('favourites'));\r\n\r\n    if(!favMoviesPerUser) {\r\n      favMoviesPerUser = { [this.currentUser.id]: favMovies};\r\n    } else {\r\n      favMoviesPerUser[this.currentUser.id] = favMovies;\r\n    }\r\n\r\n    localStorage.setItem('favourites', JSON.stringify(favMoviesPerUser));\r\n  }\r\n\r\n  doYearFilter() {\r\n    if (this.filterByYear === 0) {\r\n      this.filterByYear = null;\r\n    }\r\n  }\r\n\r\n  doGenreFilter() {\r\n    if (this.filterByGenre === 0) {\r\n      this.filterByGenre = null;\r\n    }\r\n  }\r\n\r\n  flatten(arr) {\r\n    return arr.reduce((flat, toFlatten) => {\r\n      return flat.concat(Array.isArray(toFlatten) ? this.flatten(toFlatten) : toFlatten);\r\n    }, []);\r\n  }\r\n\r\n}\r\n","<div class=\"home-page\" fxFlex=\"100\" fxLayout=\"row wrap\">\r\n  <h2 fxFlex=\"100\">Movie List Filter</h2>\r\n  <span fxFlex=\"40\">\r\n      <mat-form-field fxFlex=\"90\" class=\"form-field\">\r\n            <mat-label>Search Movies</mat-label>\r\n            <input matInput\r\n                   #searchInput\r\n                   [formControl]=\"searchField\">\r\n        </mat-form-field>\r\n    </span>\r\n  <span fxFlex=\"20\">\r\n     <mat-form-field [color]=\"'primary'\" appearance=\"outline\" class=\"btr-form-field\">\r\n            <mat-label>Filter By Year</mat-label>\r\n            <mat-select [(ngModel)]=\"filterByYear\" (selectionChange)=\"doYearFilter()\">\r\n              <mat-option *ngFor=\"let year of movieYears\"\r\n                          [value]=\"year\">\r\n                {{ year }}\r\n              </mat-option>\r\n               <mat-option [value]=\"0\">\r\n                Clear Filter\r\n              </mat-option>\r\n            </mat-select>\r\n          </mat-form-field>\r\n    </span>\r\n  <span fxFlex=\"20\">\r\n     <mat-form-field [color]=\"'primary'\" appearance=\"outline\" class=\"btr-form-field\">\r\n            <mat-label>Filter By Genre</mat-label>\r\n            <mat-select [(ngModel)]=\"filterByGenre\" (selectionChange)=\"doGenreFilter()\">\r\n              <mat-option *ngFor=\"let genre of movieGenres\"\r\n                          [value]=\"genre\">\r\n                {{ genreName[genre] }}\r\n              </mat-option>\r\n                <mat-option [value]=\"0\">\r\n                Clear Filter\r\n              </mat-option>\r\n            </mat-select>\r\n          </mat-form-field>\r\n    </span>\r\n  <span fxFlex=\"20\">\r\n        <mat-form-field [color]=\"'primary'\" appearance=\"outline\" class=\"btr-form-field\">\r\n            <mat-label>Sorty By</mat-label>\r\n            <mat-select [(ngModel)]=\"sortBy\" (selectionChange)=\"updateSort()\">\r\n              <mat-option\r\n                [value]=\"'year'\">\r\n                Sort by Year\r\n              </mat-option>\r\n              <mat-option\r\n                [value]=\"'name'\">\r\n                Sort by Name\r\n              </mat-option>\r\n            </mat-select>\r\n          </mat-form-field>\r\n    </span>\r\n  <div class=\"searching\" fxFlex=\"100\" *ngIf=\"loading\">Searching....</div>\r\n  <div class=\"movies-container\" fxLayout=\"row wrap\" fxLayoutGap=\"10px\" fxFlex=\"100\">\r\n    <ng-container *ngFor=\"let movie of sortedAndFilteredMovies\">\r\n      <mat-card class=\"movie\" fxFlex=\"1 1 24\" fxFlex.lt-lg=\"0 1 48\" fxFlex.lt-sm=\"0 1 95\" fxLayout=\"column wrap\" fxLayoutAlign=\"center center\" fxLayoutGap=\"20px\">\r\n        <div class=\"favourites\" fxLayoutAlign=\"center center\">\r\n          <i class=\"fas fa-heart\"></i>\r\n          <fa-icon [icon]=\"faHeart\" [ngClass]=\"{ 'is-favorite' : movie.isFavourite }\" (click)=\"toggleFavourites(movie)\"></fa-icon>\r\n        </div>\r\n        <div class=\"photo-container\"\r\n             *ngIf=\"movie.posterURL\"\r\n             [ngStyle]=\"{'width': '200px', 'height': '305px'}\">\r\n          <img class=\"photo-tag\"\r\n               *ngIf=\"movie.posterURL\"\r\n               [ngStyle]=\" {'width': '200px', 'height': '305px' }\"\r\n               src=\"{{movie.posterURL}}\"/>\r\n        </div>\r\n        <div fxLayout=\"row wrap\">\r\n          <div class=\"user-info\" fxFlex=\"calc(100%-60px)\" fxLayout=\"row wrap\" fxLayoutAlign=\"start start\">\r\n            <div class=\"pointer\" fxFlex=\"100\" (click)=\"showMovieDetails(movie)\">\r\n              <span class=\"movie-title\">{{movie.name}}</span>\r\n            </div>\r\n            <div fxFlex=\"100\">Year: <span class=\"bold\">{{movie.year}}</span></div>\r\n          </div>\r\n          <div fxFlex=\"calc(60px)\" class=\"rating-wrapper\" fxLayout=\"row wrap\" fxLayoutAlign=\"center start\">\r\n            <div fxFlex=\"100\">Rating:</div>\r\n            <div class=\"rating\" fxFlex=\"100\">\r\n              <span>{{ movie.rating }}</span>\r\n            </div>\r\n          </div>\r\n          <div fxFlex=\"100\" fxLayoutAlign=\"start start\">\r\n            <div fxFlex=\"100\" *ngIf=\"movie.genre.length\">Genre: <span class=\"genre-token\"\r\n                                                                      *ngFor=\"let genre of movie.genre\">{{genreName[genre]}} </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </mat-card>\r\n    </ng-container>\r\n  </div>\r\n</div>\r\n","import { Routes } from '@angular/router';\r\nimport { HomeComponent } from './home.component';\r\n\r\nexport const HomeRoutes: Routes = [\r\n  {\r\n    path: '',\r\n    pathMatch: 'full',\r\n    component: HomeComponent,\r\n  }\r\n];\r\n","import { NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\nimport { HomeRoutes } from './home.routes';\nimport { SharedModule } from '@shared/shared.module';\nimport { HomeComponent } from './home.component';\n\n@NgModule({\n  imports: [\n    SharedModule,\n    RouterModule.forChild(HomeRoutes),\n  ],\n  declarations: [\n    HomeComponent\n  ],\n  exports: [\n  ]\n})\nexport class HomeModule {\n}\n"],"sourceRoot":"webpack:///"}